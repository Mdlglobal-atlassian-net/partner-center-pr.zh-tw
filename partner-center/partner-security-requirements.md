---
title: 合作夥伴安全性需求 | 合作夥伴中心
ms.topic: article
ms.date: 09/25/2019
description: 瞭解參與雲端解決方案提供者計畫之顧問和合作夥伴的安全性需求。
author: isaiahwilliams
ms.author: iswillia
keywords: Azure Active Directory, 雲端解決方案提供者, 雲端解決方案提供者計畫, CSP, 控制台廠商, CPV, 多重要素驗證, MFA, 安全應用程式模型, 安全應用程式模型, 安全性
ms.localizationpriority: high
ms.openlocfilehash: ea155cf760850def85146d8c4e7e847fab5d7213
ms.sourcegitcommit: 0195355f4526362f4d89f59ea643a5e422b6a9b2
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/27/2019
ms.locfileid: "71318482"
---
# <a name="partner-security-requirements"></a><span data-ttu-id="7dca1-104">合作夥伴安全性需求</span><span class="sxs-lookup"><span data-stu-id="7dca1-104">Partner Security Requirements</span></span>

<span data-ttu-id="7dca1-105">**適用於**</span><span class="sxs-lookup"><span data-stu-id="7dca1-105">**Applies to**</span></span>

- <span data-ttu-id="7dca1-106">雲端解決方案提供者計畫中的所有合作夥伴</span><span class="sxs-lookup"><span data-stu-id="7dca1-106">All partners in the Cloud Solution Provider program</span></span>
  - <span data-ttu-id="7dca1-107">直接帳單</span><span class="sxs-lookup"><span data-stu-id="7dca1-107">Direct bill</span></span>
  - <span data-ttu-id="7dca1-108">間接提供者</span><span class="sxs-lookup"><span data-stu-id="7dca1-108">Indirect provider</span></span>
  - <span data-ttu-id="7dca1-109">間接轉銷商</span><span class="sxs-lookup"><span data-stu-id="7dca1-109">Indirect reseller</span></span>
- <span data-ttu-id="7dca1-110">所有控制台廠商</span><span class="sxs-lookup"><span data-stu-id="7dca1-110">All Control Panel Vendors</span></span>
- <span data-ttu-id="7dca1-111">所有顧問</span><span class="sxs-lookup"><span data-stu-id="7dca1-111">All Advisors</span></span>

<span data-ttu-id="7dca1-112">較高的隱私權保護和安全性是我們最優先的考量。</span><span class="sxs-lookup"><span data-stu-id="7dca1-112">Greater privacy safeguards and security are among our top priorities.</span></span> <span data-ttu-id="7dca1-113">我們知道最佳的防禦是預防，而且我們只與最弱的連結一樣強大。</span><span class="sxs-lookup"><span data-stu-id="7dca1-113">We know that the best defense is prevention and that we are only as strong as our weakest link.</span></span> <span data-ttu-id="7dca1-114">這就是為什麼我們需要生態系統中的每個人都採取行動，並確保其具備適當的安全性保護。</span><span class="sxs-lookup"><span data-stu-id="7dca1-114">That is why we need everyone in our ecosystem to act and ensure they have appropriate security protections in place.</span></span> <span data-ttu-id="7dca1-115">為了協助保護合作夥伴和客戶，我們針對參與雲端解決方案提供者計畫的顧問、控制台廠商和合作夥伴推出一組強制性的安全性需求。</span><span class="sxs-lookup"><span data-stu-id="7dca1-115">To help safeguard partners and customers, we’re introducing a set of mandatory security requirements for Advisors, Control Panel Vendors, and partners participating in the Cloud Solution Provider program.</span></span>

<span data-ttu-id="7dca1-116">自 2019 年 8 月 1 日起，所有合作夥伴都必須針對其合作夥伴租用戶的所有使用者 (包括服務帳戶) 強制執行多重要素驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-116">Starting August 1, 2019 all partners are required to enforce multi-factor authentication for all users, including service accounts, in their partner tenant.</span></span>

> [!NOTE]
> <span data-ttu-id="7dca1-117">我們強烈建議所有合作夥伴透過主權雲端 (21Vianet、US Government 和 Germany) 進行交易，並立即採取這些新的安全性需求。</span><span class="sxs-lookup"><span data-stu-id="7dca1-117">We strongly recommend that all partners transacting through a sovereign cloud (21Vianet, US Government, and Germany) act and adopt these new security requirements immediately.</span></span> <span data-ttu-id="7dca1-118">不過，這些合作夥伴不需要符合 2019 年 8 月 1 日生效的新安全性需求。</span><span class="sxs-lookup"><span data-stu-id="7dca1-118">However, these partners are not required to meet the new security requirements effective August 1, 2019.</span></span> <span data-ttu-id="7dca1-119">Microsoft 未來將針對主權雲端的這些安全性需求強制執行，提供額外的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7dca1-119">Microsoft will provide additional details regarding the enforcement of these security requirements for sovereign clouds in the future.</span></span>

<span data-ttu-id="7dca1-120">與合作夥伴安全性需求相關聯的條款已新增至[雲端解決方案提供者計畫指南](https://go.microsoft.com/fwlink/p/?LinkId=617100)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-120">The terms associated with the partner security requirements have been added to the [Cloud Solution Provider program guide](https://go.microsoft.com/fwlink/p/?LinkId=617100).</span></span> <span data-ttu-id="7dca1-121">自 2019 年 8 月 1 日起，參與雲端解決方案提供者計畫的所有合作夥伴都必須遵守條款。</span><span class="sxs-lookup"><span data-stu-id="7dca1-121">Starting on August 1, 2019 all partners participating in the Cloud Solution Provider program should be in compliance with the terms.</span></span> <span data-ttu-id="7dca1-122">與顧問相關的是，相同的合約需求也將備妥。</span><span class="sxs-lookup"><span data-stu-id="7dca1-122">As it relates to Advisors the same contractual requirements will be in place.</span></span>

<span data-ttu-id="7dca1-123">一旦強制執行這些需求，未實作強制安全性需求的合作夥伴，將無法在雲端解決方案提供者計畫中進行交易，或利用委派系統管理員權限來管理客戶租用戶。</span><span class="sxs-lookup"><span data-stu-id="7dca1-123">Partners who do not implement the mandatory security requirements will not be able to transact in the Cloud Solution Provider program or manage customer tenants leveraging delegate admin rights, once these requirements are enforced.</span></span> <span data-ttu-id="7dca1-124">我們正處於為需求建立技術強制執行日期的過程，並且將通知合作夥伴相關的日期與詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="7dca1-124">We are in the process of establishing a technical enforcement date for the requirements and will notify partners of the date with detailed information.</span></span>

## <a name="what-actions-do-i-need-to-take"></a><span data-ttu-id="7dca1-125">我需要採取什麼動作？</span><span class="sxs-lookup"><span data-stu-id="7dca1-125">What actions do I need to take?</span></span>

<span data-ttu-id="7dca1-126">基於成為合作夥伴的高度特殊權限本質，我們必須確保每個使用者的每個單一驗證都有 MFA 挑戰。</span><span class="sxs-lookup"><span data-stu-id="7dca1-126">Given the highly privileged nature of being a partner we need to ensure that each user has an MFA challenge for every single authentication.</span></span> <span data-ttu-id="7dca1-127">您可以透過下列其中一種方式來完成這項作業</span><span class="sxs-lookup"><span data-stu-id="7dca1-127">This can be accomplished through one of the following ways</span></span>

- <span data-ttu-id="7dca1-128">實作 Azure AD Premium 並確保對每個使用者強制執行 MFA</span><span class="sxs-lookup"><span data-stu-id="7dca1-128">Implementing Azure AD Premium and ensure that MFA is enforced for each user</span></span>
- <span data-ttu-id="7dca1-129">實作[基準保護原則](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection)</span><span class="sxs-lookup"><span data-stu-id="7dca1-129">Implementing the [baseline protection policies](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection)</span></span>
- <span data-ttu-id="7dca1-130">實作協力廠商解決方案，並確保對每個使用者強制執行 MFA</span><span class="sxs-lookup"><span data-stu-id="7dca1-130">Implementing a third-party solution and ensure MFA is enforced for each user</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7dca1-131">實際上強制執行這些需求之後，每個單一驗證都必須有 MFA 挑戰。</span><span class="sxs-lookup"><span data-stu-id="7dca1-131">Once these requirements are technically enforced every single authentication must have an MFA challenge.</span></span> <span data-ttu-id="7dca1-132">存取 Microsoft 商業雲端服務時，您將無法使用條件式存取的任何功能來避免使用 MFA 進行驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-132">You will not be able to use any feature of conditional access to avoid authenticating using MFA when access Microsoft commercial cloud services.</span></span>

### <a name="considerations"></a><span data-ttu-id="7dca1-133">考量</span><span class="sxs-lookup"><span data-stu-id="7dca1-133">Considerations</span></span>

<span data-ttu-id="7dca1-134">因為這些需求適用於您的合作夥伴租用戶中的所有使用者 (包括服務帳戶)，要確保順利部署，需要進行幾項考量。</span><span class="sxs-lookup"><span data-stu-id="7dca1-134">Because these requirements apply to all users, including service accounts, in your partner tenant, there are several considerations that need to be made to ensure a smooth deployment.</span></span> <span data-ttu-id="7dca1-135">這些考量包括識別 Azure AD 中無法執行 MFA 的使用者，以及組織所使用不支援新式驗證的應用程式和裝置。</span><span class="sxs-lookup"><span data-stu-id="7dca1-135">These considerations include identifying users in Azure AD that cannot perform MFA, as well as applications and devices used by your organization that do not support modern authentication.</span></span>

<span data-ttu-id="7dca1-136">執行任何動作之前，建議您先找出下列各項</span><span class="sxs-lookup"><span data-stu-id="7dca1-136">Prior to performing any action, it is recommended that you identify the following</span></span>

#### <a name="do-you-have-an-application-or-device-that-does-not-support-the-use-of-mfa-when-authenticating"></a><span data-ttu-id="7dca1-137">您是否有驗證時不支援使用 MFA 的應用程式或裝置？</span><span class="sxs-lookup"><span data-stu-id="7dca1-137">Do you have an application or device that does not support the use of MFA when authenticating?</span></span>

<span data-ttu-id="7dca1-138">當您強制執行 MFA 舊版驗證時，將會封鎖使用 IMAP、POP3、SMTP 等通訊協定，因為這些通訊協定不支援 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-138">When you enforce MFA legacy authentication use protocols such as IMAP, POP3, SMTP, etc. will be blocked because these protocols do not support MFA.</span></span> <span data-ttu-id="7dca1-139">若要解決此限制，稱為[應用程式密碼](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#app-passwords)的功能可用來確保應用程式或裝置仍然可以進行驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-139">To address this limitation a feature known as [app passwords](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#app-passwords) can be used to ensure the application or device can still authenticate.</span></span> <span data-ttu-id="7dca1-140">您應該複查[這裡](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#considerations-about-app-passwords)所記載、使用應用程式密碼的考量事項，以判斷是否可以在您的環境中使用它們。</span><span class="sxs-lookup"><span data-stu-id="7dca1-140">You should review the considerations for using app passwords documented [here](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings#considerations-about-app-passwords) to determine if they can be used in your environment.</span></span>

#### <a name="do-you-have-users-using-office-365-provided-by-licenses-associated-with-your-partner-tenant"></a><span data-ttu-id="7dca1-141">您是否有使用者使用與合作夥伴租用戶使用者相關聯的授權所提供的 Office 365？</span><span class="sxs-lookup"><span data-stu-id="7dca1-141">Do you have users using Office 365 provided by licenses associated with your partner tenant?</span></span>

<span data-ttu-id="7dca1-142">在實作任何解決方案之前，建議您先判斷合作夥伴租用戶中的使用者使用的 Microsoft Office 版本為何。</span><span class="sxs-lookup"><span data-stu-id="7dca1-142">Prior to implementing any solution, it is recommended that you determine why version of Microsoft Office is being used by users in your partner tenant.</span></span> <span data-ttu-id="7dca1-143">在採取任何動作之前，先複查[規劃 Office 365 部署的多重要素驗證](https://docs.microsoft.com/office365/admin/security-and-compliance/multi-factor-authentication-plan#enable-mfa)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-143">Review [plan for multi-factor authentication for Office 365 Deployments](https://docs.microsoft.com/office365/admin/security-and-compliance/multi-factor-authentication-plan#enable-mfa) before taking any action.</span></span> <span data-ttu-id="7dca1-144">您的使用者可能會遇到 Outlook 之類應用程式的連線問題。</span><span class="sxs-lookup"><span data-stu-id="7dca1-144">There is a chance your users will experience connectivity issues with applications like Outlook.</span></span> <span data-ttu-id="7dca1-145">強制執行 MFA 之前，請務必確定正在使用 Outlook 2013 SP1 或更新版本，且您的組織已啟用新式驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-145">Before enforcing MFA, it important to ensure that Outlook 2013 SP1, or later, is being used and that your organization has modern authentication enabled.</span></span> <span data-ttu-id="7dca1-146">如需詳細資訊，請參閱[在 Exchange Online 中啟用新式驗證](https://docs.microsoft.com/exchange/clients-and-mobile-in-exchange-online/enable-or-disable-modern-authentication-in-exchange-online)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-146">See [Enable modern authentication in Exchange Online](https://docs.microsoft.com/exchange/clients-and-mobile-in-exchange-online/enable-or-disable-modern-authentication-in-exchange-online) for more information.</span></span>

<span data-ttu-id="7dca1-147">若要為執行 Windows 且已安裝 Microsoft Office 2013 的任何裝置啟用新式驗證，您將需要建立兩個登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="7dca1-147">To enable modern authentication for any devices running Windows, that have Microsoft Office 2013 installed, you will need to create two registry keys.</span></span> <span data-ttu-id="7dca1-148">請參閱[為 Windows 裝置上的 Office 2013 啟用新式驗證](https://docs.microsoft.com/office365/admin/security-and-compliance/enable-modern-authentication)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-148">See [Enable Modern Authentication for Office 2013 on Windows devices](https://docs.microsoft.com/office365/admin/security-and-compliance/enable-modern-authentication).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7dca1-149">如果您已為使用者啟用 Azure AD MFA，而且有任何執行 Office 2013 的裝置未啟用新式驗證，他們就必須在這些裝置上使用應用程式密碼。</span><span class="sxs-lookup"><span data-stu-id="7dca1-149">If you have enabled your users for Azure AD MFA and they have any devices running Office 2013 that are not enabled for modern authentication, they will need to use App Passwords on those devices.</span></span> <span data-ttu-id="7dca1-150">如需有關應用程式密碼的詳細資訊，以及其使用時機/位置/方式，請參閱：[應用程式密碼搭配 Azure Multi-Factor Authentication](https://go.microsoft.com/fwlink/p/?LinkId=528178)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-150">More information on App Passwords and when/where/how they should be used can be found here: [App Passwords with Azure Multi-Factor Authentication](https://go.microsoft.com/fwlink/p/?LinkId=528178).</span></span>

#### <a name="is-there-a-policy-preventing-any-of-your-users-from-using-their-mobile-devices-while-working"></a><span data-ttu-id="7dca1-151">是否有原則防止任何使用者在工作時使用其行動裝置？</span><span class="sxs-lookup"><span data-stu-id="7dca1-151">Is there a policy preventing any of your users from using their mobile devices while working?</span></span>

<span data-ttu-id="7dca1-152">請務必找出會防止員工在工作時使用行動裝置的任何公司原則，因為它會影響您所實作的 MFA 解決方案。</span><span class="sxs-lookup"><span data-stu-id="7dca1-152">It is important to identify any corporate policy that prevents employees from using mobile devices while working because it will influence what MFA solution you implement.</span></span> <span data-ttu-id="7dca1-153">部分 MFA 解決方案，例如透過[基準保護原則](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection)所實作的解決方案，只會允許使用驗證器應用程式進行驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-153">There are MFA solutions, such as the one provided through the implementation of the [baseline protection policies](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection), that only allow the use of an authenticator app for verification.</span></span> <span data-ttu-id="7dca1-154">如果您的組織有防止使用行動裝置的原則，則應該考量下列其中一個選項</span><span class="sxs-lookup"><span data-stu-id="7dca1-154">In the event your organization has a policy that prevent the use of mobile devices, then you should consider one of the following options</span></span>

- <span data-ttu-id="7dca1-155">部署可在安全系統上執行的以時間為基礎的一次性基礎密碼 (TOTP) 應用程式</span><span class="sxs-lookup"><span data-stu-id="7dca1-155">Deploy a time-based one-time base password (TOTP) application that can run on secure system</span></span>
- <span data-ttu-id="7dca1-156">實作協力廠商解決方案，在可提供最適當驗證選項的合作夥伴租用戶中，為每個使用者強制執行 MFA</span><span class="sxs-lookup"><span data-stu-id="7dca1-156">Implement a third-party solution that enforces MFA for each user in the partner tenant that provides the most appropriate verification option</span></span>
- <span data-ttu-id="7dca1-157">為受影響的使用者購買 [Azure AD Premium](https://azure.microsoft.com/pricing/details/active-directory/) 授權</span><span class="sxs-lookup"><span data-stu-id="7dca1-157">Purchasing [Azure AD Premium](https://azure.microsoft.com/pricing/details/active-directory/) licenses for the impacted users</span></span>

<span data-ttu-id="7dca1-158">支援使用 FIDO 安全性金鑰在基準保護原則的藍圖上。</span><span class="sxs-lookup"><span data-stu-id="7dca1-158">Support for the use of FIDO security keys is on the road map for the baseline protection policies.</span></span> <span data-ttu-id="7dca1-159">新增支援之後，您將可以針對驗證的第二個因素使用 FIDO 安全性金鑰。</span><span class="sxs-lookup"><span data-stu-id="7dca1-159">Once support has been added, you will be able to leverage FIDO security keys for the second factor of authentication.</span></span> <span data-ttu-id="7dca1-160">在那之前，您將受限於使用驗證器應用程式。</span><span class="sxs-lookup"><span data-stu-id="7dca1-160">Until then you are limited to the use of the Authenticator App.</span></span>

#### <a name="what-automation-or-integration-do-you-have-that-leverages-user-credentials-for-authentication"></a><span data-ttu-id="7dca1-161">您有會利用使用者認證進行驗證的哪些自動化或整合？</span><span class="sxs-lookup"><span data-stu-id="7dca1-161">What automation or integration do you have that leverages user credentials for authentication?</span></span>

<span data-ttu-id="7dca1-162">由於需求是對合作夥伴目錄中的每個使用者 (包括服務帳戶) 強制執行 MFA，因此，利用使用者認證進行驗證的任何自動化或整合都會受到影響。</span><span class="sxs-lookup"><span data-stu-id="7dca1-162">Since the requirement is to enforce MFA for each user, including service accounts, in your partner directory any automation or integration that leverages user credentials for authentication will be impacted.</span></span> <span data-ttu-id="7dca1-163">因此，請務必找出在這些情況下所使用的帳戶。</span><span class="sxs-lookup"><span data-stu-id="7dca1-163">So, it important that you identify what accounts are being used in these situations.</span></span> <span data-ttu-id="7dca1-164">以下是應該考量的應用程式或服務的範例清單</span><span class="sxs-lookup"><span data-stu-id="7dca1-164">The following is a list of examples of applications or services that should be considered</span></span>

- <span data-ttu-id="7dca1-165">用來代表您的客戶佈建資源的控制台</span><span class="sxs-lookup"><span data-stu-id="7dca1-165">Control panel used to provision resources on behalf of your customers</span></span>
- <span data-ttu-id="7dca1-166">與用於發票 (與雲端解決方案提供者計畫相關) 的任何平台整合並支援您的客戶</span><span class="sxs-lookup"><span data-stu-id="7dca1-166">Integration with any platform that is used for invoicing (as it relates to the CSP program) and supporting your customers</span></span>
- <span data-ttu-id="7dca1-167">使用 Az、AzureRM、Azure AD、MS Online 等模組的 PowerShell 指令碼</span><span class="sxs-lookup"><span data-stu-id="7dca1-167">PowerShell scripts that utilize the Az, AzureRM, Azure AD, MS Online, etc. modules</span></span>

<span data-ttu-id="7dca1-168">以上清單並不完整。</span><span class="sxs-lookup"><span data-stu-id="7dca1-168">The above list is not comprehensive.</span></span> <span data-ttu-id="7dca1-169">因此，在利用使用者認證來進行驗證的環境中，請務必執行任何應用程式或服務的完整評估。</span><span class="sxs-lookup"><span data-stu-id="7dca1-169">So, it important that you perform a complete assessment of any application or service in your environment that leverages user credentials for authentication.</span></span> <span data-ttu-id="7dca1-170">若要與 MFA 的需求抗衡，您應該盡可能在[安全應用程式模型架構](https://docs.microsoft.com/partner-center/develop/enable-secure-app-model)中實作指導方針。</span><span class="sxs-lookup"><span data-stu-id="7dca1-170">To contend with the requirement for MFA, you should implement the guidance in the [Secure Application Model framework](https://docs.microsoft.com/partner-center/develop/enable-secure-app-model) where possible.</span></span> <span data-ttu-id="7dca1-171">以下是可協助您瞭解如何實作安全應用程式模型架構的其他資源</span><span class="sxs-lookup"><span data-stu-id="7dca1-171">The following are additional resources that will help you understand how the Secure Application Model framework can be implemented</span></span>

- <span data-ttu-id="7dca1-172">[合作夥伴中心 .NET 範例](https://github.com/microsoft/partner-center-dotnet-samples) - 此 GitHub 存放庫包含使用 .NET 開發的範例，將示範如何實作安全應用程式模型架構。</span><span class="sxs-lookup"><span data-stu-id="7dca1-172">[Partner Center .NET Samples](https://github.com/microsoft/partner-center-dotnet-samples) - This GitHub repository contains samples, developed using .NET, that will demonstrate how you can implement the Secure Application Model framework.</span></span>
- <span data-ttu-id="7dca1-173">[合作夥伴中心 Java 範例](https://github.com/microsoft/partner-center-java-samples) - 此 GitHub 存放庫包含使用 Java 開發的範例，將示範如何實作安全應用程式模型架構。</span><span class="sxs-lookup"><span data-stu-id="7dca1-173">[Partner Center Java Samples](https://github.com/microsoft/partner-center-java-samples) - This GitHub repository contains samples, developed using Java, that will demonstrate how you can implement the Secure Application Model framework.</span></span>
- <span data-ttu-id="7dca1-174">[合作夥伴中心 PowerShell - 安全應用程式模型](https://docs.microsoft.com/powershell/partnercenter/secure-app-model) - 本文章提供如何使用 PowerShell 來實作安全應用程式模型架構的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7dca1-174">[Partner Center PowerShell - Secure Application Model](https://docs.microsoft.com/powershell/partnercenter/secure-app-model) - This is an article that provides details on how to implement the Secure Application Model framework using PowerShell.</span></span>
- <span data-ttu-id="7dca1-175">[合作夥伴中心安全性指導群組社群](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) - 這是線上社群，您可以在其中瞭解近期活動，並詢問您可能會遇到的任何問題。</span><span class="sxs-lookup"><span data-stu-id="7dca1-175">[Partner Center Security Guidance Group community](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) - This is online community where you can learn about upcoming events and ask any questions that you might have.</span></span>

### <a name="enforcing-mfa-for-all-users"></a><span data-ttu-id="7dca1-176">為所有使用者強制執行 MFA</span><span class="sxs-lookup"><span data-stu-id="7dca1-176">Enforcing MFA for all users</span></span>

<span data-ttu-id="7dca1-177">本節將涵蓋如何使用[基準保護原則](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection)，為您的合作夥伴租用戶中的每個使用者 (包括服務帳戶) 強制執行 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-177">This section will cover how you can use the [baseline protection policies](https://docs.microsoft.com/azure/active-directory/conditional-access/concept-baseline-protection) to enforce MFA for each user, including service accounts, in your partner tenant.</span></span> <span data-ttu-id="7dca1-178">如果您計畫使用 Azure AD Premium，請遵循[這裡](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-getstarted)記載的步驟。</span><span class="sxs-lookup"><span data-stu-id="7dca1-178">If you are planning to use Azure AD Premium, then follow the steps documented [here](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-getstarted).</span></span>

> [!NOTE]
> <span data-ttu-id="7dca1-179">您可以使用與 Azure AD 相容的協力廠商解決方案，針對所有使用者 (包括服務帳戶) 強制執行 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-179">A third-party solution, that is compatible with Azure AD, can be used to enforce MFA for all users, including, service accounts.</span></span> <span data-ttu-id="7dca1-180">如需應如何實作解決方案的詳細資訊，請參閱廠商提供的文件。</span><span class="sxs-lookup"><span data-stu-id="7dca1-180">Refer to the documentation from the vendor for more details on how the solution should be implemented.</span></span>

<span data-ttu-id="7dca1-181">基準保護原則是一組預先定義的原則，可協助組織抵禦許多常見的攻擊。</span><span class="sxs-lookup"><span data-stu-id="7dca1-181">Baseline protection policies are a set of predefined policies that help protect organizations against many common attacks.</span></span> <span data-ttu-id="7dca1-182">這些常見的攻擊可能包括密碼噴灑、重播和網路釣魚。</span><span class="sxs-lookup"><span data-stu-id="7dca1-182">These common attacks can include password spray, replay, and phishing.</span></span> <span data-ttu-id="7dca1-183">基準保護原則可在所有版本的 Azure Active Directory 中取得。</span><span class="sxs-lookup"><span data-stu-id="7dca1-183">Baseline protection policies are available in all editions of Azure Active Directory.</span></span> <span data-ttu-id="7dca1-184">Microsoft 正讓所有人都能使用這些基準保護原則，以進一步讓客戶和合作夥伴實作最佳的安全性作法。</span><span class="sxs-lookup"><span data-stu-id="7dca1-184">Microsoft is making these baseline protection policies available to everyone to further enable customers and partners to implement best-in-class security practices.</span></span>

<span data-ttu-id="7dca1-185">下表說明應啟用的兩個基準保護原則。</span><span class="sxs-lookup"><span data-stu-id="7dca1-185">The two baseline protection policies that should be enabled are described in the table below.</span></span>

|<span data-ttu-id="7dca1-186">**原則**</span><span class="sxs-lookup"><span data-stu-id="7dca1-186">**Policy**</span></span>| |
|-----|-----|
|<span data-ttu-id="7dca1-187">**要求系統管理員使用 MFA**</span><span class="sxs-lookup"><span data-stu-id="7dca1-187">**Require MFA for admins**</span></span>|<span data-ttu-id="7dca1-188">啟用 [要求系統管理員使用 MFA] 原則時，將要求系統管理員角色中的使用者使用 Authenticator 應用程式來註冊使用 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-188">Enabling the Require MFA for admins policy, will require users in the administrator roles to register for MFA using the Authenticator App.</span></span> <span data-ttu-id="7dca1-189">完成 MFA 註冊後，管理員每次登入時都必須執行 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-189">Once MFA registration is complete, administrators will need to perform MFA every time they sign-in.</span></span>|
|<span data-ttu-id="7dca1-190">**使用者保護**</span><span class="sxs-lookup"><span data-stu-id="7dca1-190">**End user protection**</span></span>|<span data-ttu-id="7dca1-191">使用者保護是以風險為基礎的 MFA 基準保護原則，可保護目錄中的所有使用者。</span><span class="sxs-lookup"><span data-stu-id="7dca1-191">End user protection is a risk-based MFA baseline protection policy that protects all users in a directory.</span></span> <span data-ttu-id="7dca1-192">啟用此原則會要求所有使用者都必須使用驗證器應用程式註冊 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-192">Enabling this policy requires all users to register for MFA using the Authenticator App.</span></span> <span data-ttu-id="7dca1-193">使用者可以略過 MFA 註冊提示 14 天，在這之後，他們將會遭到封鎖而無法登入，直到他們註冊 MFA 為止。</span><span class="sxs-lookup"><span data-stu-id="7dca1-193">Users can ignore the MFA registration prompt for 14 days, after which they will be blocked from signing in until they register for MFA.</span></span> <span data-ttu-id="7dca1-194">註冊 MFA 之後，只有在有風險的登入嘗試時，才會提示使用者進行 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-194">Once registered for MFA, users will be prompted for MFA only during risky sign-in attempts.</span></span> <span data-ttu-id="7dca1-195">遭盜用的使用者帳戶會遭到封鎖，直到重設其密碼且風險事件已解除為止。</span><span class="sxs-lookup"><span data-stu-id="7dca1-195">Compromised user accounts are blocked until their password is reset and risk events have been dismissed.</span></span>|

<span data-ttu-id="7dca1-196">啟用這些原則時，每個使用者都可以使用驗證器應用程式來利用 Azure MFA 來進行驗證，而不需要額外付費。</span><span class="sxs-lookup"><span data-stu-id="7dca1-196">When these policies are enabled, each user will be able to utilize Azure MFA using the Authenticator App for verification at no additional cost.</span></span>

#### <a name="configure-self-service-password-reset"></a><span data-ttu-id="7dca1-197">設定自助式密碼重設</span><span class="sxs-lookup"><span data-stu-id="7dca1-197">Configure Self Service Password Reset</span></span>

<span data-ttu-id="7dca1-198">自助式密碼重設 (SSPR) 是一項 Azure Active Directory 功能，可讓使用者重設其密碼，而不需連絡其支援小組。</span><span class="sxs-lookup"><span data-stu-id="7dca1-198">Self-service password reset (SSPR) is an Azure Active Directory feature that enables users to reset their passwords without needing to contact their support team.</span></span> <span data-ttu-id="7dca1-199">使用者必須註冊或由他人為其註冊取得自助式密碼重設，才能使用服務。</span><span class="sxs-lookup"><span data-stu-id="7dca1-199">Users must register for or be registered for self-service password reset before using the service.</span></span> <span data-ttu-id="7dca1-200">在註冊期間，使用者會選擇其組織所啟用的一或多個驗證方法。</span><span class="sxs-lookup"><span data-stu-id="7dca1-200">During registration, the user chooses one or more authentication methods enabled by their organization.</span></span>

<span data-ttu-id="7dca1-201">啟用[使用者保護](https://docs.microsoft.com/azure/active-directory/conditional-access/howto-baseline-protect-end-users)基準保護原則時，任何遭盜用的使用者帳戶將會遭到封鎖，直到重設其密碼且風險事件已解除為止。</span><span class="sxs-lookup"><span data-stu-id="7dca1-201">When the [End user protection](https://docs.microsoft.com/azure/active-directory/conditional-access/howto-baseline-protect-end-users) baseline protection policy is enabled, any compromised user accounts will be blocked until their password is reset and the risk events have been dismissed.</span></span> <span data-ttu-id="7dca1-202">考慮到這一點，建議由身為全域管理員的每位使用者執行下列動作來註冊 SSPR，使得他們不會遭到鎖定。</span><span class="sxs-lookup"><span data-stu-id="7dca1-202">Considering this it is recommended that each user, who is a global admin, perform the following to register for SSPR so they do not get locked out.</span></span>

1. <span data-ttu-id="7dca1-203">瀏覽至 [SSPR 設定頁面](https://aka.ms/ssprsetup)</span><span class="sxs-lookup"><span data-stu-id="7dca1-203">Browse to the [SSPR setup page](https://aka.ms/ssprsetup)</span></span>
2. <span data-ttu-id="7dca1-204">輸入您的使用者名稱和密碼</span><span class="sxs-lookup"><span data-stu-id="7dca1-204">Enter your username and password</span></span>
3. <span data-ttu-id="7dca1-205">設定至少其中一個驗證選項，以在重設密碼時用來確認您的身分。</span><span class="sxs-lookup"><span data-stu-id="7dca1-205">Configure at least one of the verifications options that will be used to verify who you are when resetting your password.</span></span>  

<span data-ttu-id="7dca1-206">當帳戶遭到入侵時，系統管理員必須採取行動，以還原受影響使用者的存取權。</span><span class="sxs-lookup"><span data-stu-id="7dca1-206">When an account has been compromised an administrator will need to take action to restore access for the impacted user.</span></span> <span data-ttu-id="7dca1-207">如需解除封鎖使用者的程序詳細資訊，請參閱[解除封鎖使用者的步驟](#recovering-compromised-accounts)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-207">See the [steps to unblock a user](#recovering-compromised-accounts) for details on the process to unblock the user.</span></span>

#### <a name="require-mfa-for-admins"></a><span data-ttu-id="7dca1-208">要求系統管理員使用 MFA</span><span class="sxs-lookup"><span data-stu-id="7dca1-208">Require MFA for admins</span></span>

<span data-ttu-id="7dca1-209">[要求管理員使用 MFA]  基準原則需要下列目錄角色的 MFA，它們被視為最具特殊權限的 Azure Active Directory 角色：</span><span class="sxs-lookup"><span data-stu-id="7dca1-209">The *Require MFA for admin* baseline policy requires MFA for the following directory roles, considered to be the most privileged Azure Active Directory roles:</span></span>

- <span data-ttu-id="7dca1-210">全域管理員</span><span class="sxs-lookup"><span data-stu-id="7dca1-210">Global administrator</span></span>
- <span data-ttu-id="7dca1-211">SharePoint 管理員</span><span class="sxs-lookup"><span data-stu-id="7dca1-211">SharePoint administrator</span></span>
- <span data-ttu-id="7dca1-212">Exchange 系統管理員</span><span class="sxs-lookup"><span data-stu-id="7dca1-212">Exchange administrator</span></span>
- <span data-ttu-id="7dca1-213">條件式存取管理員</span><span class="sxs-lookup"><span data-stu-id="7dca1-213">Conditional access administrator</span></span>
- <span data-ttu-id="7dca1-214">安全性系統管理員</span><span class="sxs-lookup"><span data-stu-id="7dca1-214">Security administrator</span></span>
- <span data-ttu-id="7dca1-215">服務台管理員/密碼管理員</span><span class="sxs-lookup"><span data-stu-id="7dca1-215">Helpdesk administrator / Password administrator</span></span>
- <span data-ttu-id="7dca1-216">計費管理員</span><span class="sxs-lookup"><span data-stu-id="7dca1-216">Billing administrator</span></span>
- <span data-ttu-id="7dca1-217">使用者管理員</span><span class="sxs-lookup"><span data-stu-id="7dca1-217">User administrator</span></span>

<span data-ttu-id="7dca1-218">啟用 [要求系統管理員使用 MFA] 原則時，需要以上九個系統管理員角色，才能使用 Authenticator 應用程式來註冊使用 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-218">Upon enabling the Require MFA for admins policy, the above nine administrator roles will be required to register for MFA using the Authenticator App.</span></span> <span data-ttu-id="7dca1-219">完成 MFA 註冊後，管理員每次登入時都必須執行 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-219">Once MFA registration is complete, administrators will need to perform MFA every single time they sign-in.</span></span>

<span data-ttu-id="7dca1-220">如果您的組織在指令碼或程式碼中使用這些帳戶，請考慮將它們取代為[受管理的身分識別](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-220">If your organization has these accounts in use in scripts or code, consider replacing them with [managed identities](https://docs.microsoft.com/azure/active-directory/managed-identities-azure-resources/overview).</span></span>

<span data-ttu-id="7dca1-221">若要啟用此原則並保護您的系統管理員：</span><span class="sxs-lookup"><span data-stu-id="7dca1-221">To enable this policy and protect your administrators:</span></span>

1. <span data-ttu-id="7dca1-222">以全域管理員、安全性系統管理員或條件式存取系統管理員的身分登入 **Azure 入口網站**。</span><span class="sxs-lookup"><span data-stu-id="7dca1-222">Sign in to the **Azure portal** as a Global Administrator, Security Administrator, or Conditional Access Administrator.</span></span>
2. <span data-ttu-id="7dca1-223">瀏覽至 [Azure Active Directory]   >  [條件式存取]  。</span><span class="sxs-lookup"><span data-stu-id="7dca1-223">Browse to **Azure Active Directory** > **Conditional Access**.</span></span>
3. <span data-ttu-id="7dca1-224">在原則清單中，選取 [基準原則:  要求系統管理員使用 MFA]。</span><span class="sxs-lookup"><span data-stu-id="7dca1-224">In the list of policies, select **Baseline policy: Require MFA for admins**.</span></span>
4. <span data-ttu-id="7dca1-225">將 [啟用原則]  設定為 [立即使用原則]  。</span><span class="sxs-lookup"><span data-stu-id="7dca1-225">Set **Enable policy** to **Use policy immediately**.</span></span>
5. <span data-ttu-id="7dca1-226">按一下 **[儲存]** 。</span><span class="sxs-lookup"><span data-stu-id="7dca1-226">Click **Save**.</span></span>

> [!WARNING]
> <span data-ttu-id="7dca1-227">啟用此原則之前，請確定您的使用者未使用舊版驗證通訊協定。</span><span class="sxs-lookup"><span data-stu-id="7dca1-227">Before you enable this policy, make sure your users are not using legacy authentication protocols.</span></span> <span data-ttu-id="7dca1-228">透過實作此原則，將會封鎖舊版驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-228">Through the implementation of this policy legacy authentication will be blocked.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7dca1-229">有一個已知的問題，會影響您使用委派系統管理權限連接到 Exchange Online PowerShell 的能力。</span><span class="sxs-lookup"><span data-stu-id="7dca1-229">There is a known issue, that impacts your ability to connect to Exchange Online PowerShell using delegated administrative privileges.</span></span> <span data-ttu-id="7dca1-230">如果您使用此 PowerShell模組，在啟用此原則之前，請參閱 [Exchange Online PowerShell](#exchange-online-powershell) 已知問題。</span><span class="sxs-lookup"><span data-stu-id="7dca1-230">See the [Exchange Online PowerShell](#exchange-online-powershell) known issue prior to enabling this policy if you using this PowerShell module.</span></span>

#### <a name="end-user-protection"></a><span data-ttu-id="7dca1-231">使用者保護</span><span class="sxs-lookup"><span data-stu-id="7dca1-231">End user protection</span></span>

<span data-ttu-id="7dca1-232">使用者保護基準原則會保護目錄中的所有使用者。</span><span class="sxs-lookup"><span data-stu-id="7dca1-232">The End user protection baseline policy protects all users in a directory.</span></span> <span data-ttu-id="7dca1-233">啟用此原則會要求所有使用者都必須在 14 天內註冊 Azure MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-233">Enabling this policy requires all users to register for Azure MFA within 14 days.</span></span> <span data-ttu-id="7dca1-234">註冊之後，只有在有風險的登入嘗試時，才會提示使用者進行 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-234">Once registered, users will be prompted for MFA only during risky sign-in attempts.</span></span> <span data-ttu-id="7dca1-235">遭盜用的使用者帳戶會遭到封鎖，直到重設密碼和風險解除為止。</span><span class="sxs-lookup"><span data-stu-id="7dca1-235">Compromised user accounts are blocked until password reset and risk dismissal.</span></span>

<span data-ttu-id="7dca1-236">原則 [基準原則:  使用者保護] 已預先設定，當您瀏覽至 Azure 入口網站中的 [條件式存取] 刀鋒視窗時，將顯示在頂端。</span><span class="sxs-lookup"><span data-stu-id="7dca1-236">The policy **Baseline policy: End user protection** comes pre-configured and will show up at the top when you navigate to the Conditional Access blade in Azure portal.</span></span>

<span data-ttu-id="7dca1-237">若要啟用此原則並保護您的使用者：</span><span class="sxs-lookup"><span data-stu-id="7dca1-237">To enable this policy and protect your users:</span></span>

1. <span data-ttu-id="7dca1-238">以全域管理員、安全性系統管理員或條件式存取系統管理員的身分登入 **Azure 入口網站**。</span><span class="sxs-lookup"><span data-stu-id="7dca1-238">Sign in to the **Azure portal** as a Global Administrator, Security Administrator, or Conditional Access Administrator.</span></span>
2. <span data-ttu-id="7dca1-239">瀏覽至 [Azure Active Directory]   >  [條件式存取]  。</span><span class="sxs-lookup"><span data-stu-id="7dca1-239">Browse to **Azure Active Directory** > **Conditional Access**.</span></span>
3. <span data-ttu-id="7dca1-240">在原則清單中，選取 [基準原則:  終端使用者保護 (預覽)]。</span><span class="sxs-lookup"><span data-stu-id="7dca1-240">In the list of policies, select **Baseline policy: End user protection (preview)**.</span></span>
4. <span data-ttu-id="7dca1-241">將 [啟用原則]  設定為 [立即使用原則]  。</span><span class="sxs-lookup"><span data-stu-id="7dca1-241">Set **Enable policy** to **Use policy immediately**.</span></span>
5. <span data-ttu-id="7dca1-242">按一下 **[儲存]** 。</span><span class="sxs-lookup"><span data-stu-id="7dca1-242">Click **Save**.</span></span>

> [!WARNING]
> <span data-ttu-id="7dca1-243">啟用此原則之前，請確定您的使用者未使用舊版驗證通訊協定。</span><span class="sxs-lookup"><span data-stu-id="7dca1-243">Before you enable this policy, make sure your users are not using legacy authentication protocols.</span></span> <span data-ttu-id="7dca1-244">透過實作此原則，將會封鎖舊版驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-244">Through the implementation of this policy legacy authentication will be blocked.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7dca1-245">有一個已知的問題，會影響您使用委派系統管理權限連接到 Exchange Online PowerShell 的能力。</span><span class="sxs-lookup"><span data-stu-id="7dca1-245">There is a known issues, that impacts your ability to connect to Exchange Online PowerShell using delegated administrative privileges.</span></span> <span data-ttu-id="7dca1-246">如果您使用此 PowerShell模組，在啟用此原則之前，請參閱 [Exchange Online PowerShell](#exchange-online-powershell) 已知問題。</span><span class="sxs-lookup"><span data-stu-id="7dca1-246">See the [Exchange Online PowerShell](#exchange-online-powershell) known issue prior to enabling this policy if you using this PowerShell module.</span></span>

## <a name="assessing-your-environment"></a><span data-ttu-id="7dca1-247">準備您的環境</span><span class="sxs-lookup"><span data-stu-id="7dca1-247">Assessing your environment</span></span>

<span data-ttu-id="7dca1-248">透過目前的合作夥伴安全性需求，您必須針對合作夥伴租用戶使用者中的每個使用者強制執行 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-248">Through one of the current partner security requirements, you are required to have MFA enforced for each user in your partner tenant.</span></span> <span data-ttu-id="7dca1-249">由於這項需求可以透過數種不同的方法來完成，因此難以評估是否需要任何額外的動作。</span><span class="sxs-lookup"><span data-stu-id="7dca1-249">Since this requirement can be fulfilled through a number of different methods it can prove difficult to assess if any additional actions are required.</span></span> <span data-ttu-id="7dca1-250">您可以利用 Azure Active Directory 稽核記錄和 [Microsoft 安全分數](https://docs.microsoft.com/office365/securitycompliance/microsoft-secure-score)之類的工具，評估是否需要採取任何其他動作，才能使用 MFA 保護您的租用戶。</span><span class="sxs-lookup"><span data-stu-id="7dca1-250">You can leverage tools like the Azure Active Directory audit logs and [Microsoft Secure Score](https://docs.microsoft.com/office365/securitycompliance/microsoft-secure-score) to evaluate if any additional actions are required to secure your tenant with the MFA.</span></span> <span data-ttu-id="7dca1-251">Microsoft 正致力於合作夥伴中心的體驗，以提供有關 MFA 和安全應用程式模型需求的快速合規性檢查。</span><span class="sxs-lookup"><span data-stu-id="7dca1-251">Microsoft is working on an experience in Partner Center to provide a quick compliance check on the MFA and the Secure Application Model requirements.</span></span>

<span data-ttu-id="7dca1-252">Microsoft 安全分數提供您強大的視覺效果、與其他 Microsoft 產品整合、將的分數與其他公司的分數比較、依類別篩選，以及其他更多功能。</span><span class="sxs-lookup"><span data-stu-id="7dca1-252">Microsoft Secure Score gives you robust visualizations, integration with other Microsoft products, comparison of your score with other companies, filtering by category, and much more.</span></span> <span data-ttu-id="7dca1-253">使用此工具，您可以完成組織內的安全性改進動作，並追蹤分數的歷程記錄。</span><span class="sxs-lookup"><span data-stu-id="7dca1-253">With this tool, you can complete security improvement actions within your organization and track the history of your score.</span></span> <span data-ttu-id="7dca1-254">當協力廠商解決方案已解決建議的改進動作時，分數也可以反映出來。</span><span class="sxs-lookup"><span data-stu-id="7dca1-254">The score can also reflect when third-party solutions have addressed recommended improvement actions.</span></span>

![Microsoft 安全分數](images/security/secure-score.png)

> [!NOTE]
> <span data-ttu-id="7dca1-256">為了改善您的 Microsoft 安全分數您可以採取的動作，最多可能需要24小時的時間才會反映出來。</span><span class="sxs-lookup"><span data-stu-id="7dca1-256">Actions you can take to improve your Microsoft Secure Score may take up to 24 hours to be reflected.</span></span>

<span data-ttu-id="7dca1-257">Microsoft 安全分數只會提供安全性狀態的數值表示法。</span><span class="sxs-lookup"><span data-stu-id="7dca1-257">Microsoft Secure Score will only provide a numerical representation of your security posture.</span></span> <span data-ttu-id="7dca1-258">若要進一步瞭解未受到 MFA 挑戰進行驗證的內容或對象，建議您查詢 Azure Active Directory 的稽核記錄。</span><span class="sxs-lookup"><span data-stu-id="7dca1-258">To better understand what or who is authenticating without being challenged for MFA, it is recommended to query the Azure Active Directory audit logs.</span></span> <span data-ttu-id="7dca1-259">您可以使用 [Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview) 模組和下列指令碼來完成此作業。</span><span class="sxs-lookup"><span data-stu-id="7dca1-259">This can be accomplished using the [Azure PowerShell](https://docs.microsoft.com/powershell/azure/overview) module and the script below.</span></span> <span data-ttu-id="7dca1-260">它會產生一份報告，讓您瞭解在過去一天發生、未受到 MFA 挑戰的驗證嘗試。</span><span class="sxs-lookup"><span data-stu-id="7dca1-260">It will generate a report that provides insight into what authentication attempts have occurred over the past day that were not challenged for MFA.</span></span>

```powershell
Login-AzAccount
$context = Get-AzContext

function Get-SignInEvents
{
    param([string]$userId)

    $content = '{"startDateTime":"' + (Get-Date).AddDays(-1).ToUniversalTime().ToString("yyyy-MM-ddT05:00:00.000Z") + '","endDateTime":"' + (Get-Date).ToUniversalTime().ToString("yyyy-MM-ddTHH:mm:ss.fffZ")  + '","userId":"' + $userId +'","riskState":[],"totalRisk":[],"realtimeRisk":[],"tokenIssuerType":[],"isAdfsEnabled":false}'

    $token = [Microsoft.Azure.Commands.Common.Authentication.AzureSession]::Instance.AuthenticationFactory.Authenticate($context.Account, $context.Environment, $context.Tenant.Id, $null, "Never", $null, "74658136-14ec-4630-ad9b-26e160ff0fc6")

    $headers = @{
    'Authorization' = 'Bearer ' + $token.AccessToken
    'Content-Type' = 'application/json'
        'X-Requested-With'= 'XMLHttpRequest'
        'x-ms-client-request-id'= [guid]::NewGuid()
        'x-ms-correlation-id' = [guid]::NewGuid()
    }

    Invoke-RestMethod -Body $content -Header $headers -Method POST -Uri "https://main.iam.ad.ext.azure.com/api/Reports/SignInEventsV3"
}

$report = $()

Get-AzADUser | foreach {
    $events = Get-SignInEvents $_.Id
    $report += $events.Items
}

$report | Where-Object {$_.mfaRequired -eq $false} | Select-Object userPrincipalName, userDisplayName, createdDateTime, resourceDisplayName, loginSucceeded, failureReason, mfaRequired, mfaAuthMethod, mfaAuthDetail, mfaResult, @{Name='policies'; Expression={[string]::join(',', $($_.conditionalAccessPolicies | Select-Object displayName).displayName )}}, conditionalAccessStatus | Export-Csv report.csv
```

<span data-ttu-id="7dca1-261">執行上述指令碼之後，report.csv 檔案中會提供詳細資料。</span><span class="sxs-lookup"><span data-stu-id="7dca1-261">After running the above script, the details will be available in the report.csv file.</span></span> <span data-ttu-id="7dca1-262">其中將包含過去一天發生、使用者未受到 MFA 挑戰的驗證嘗試清單。</span><span class="sxs-lookup"><span data-stu-id="7dca1-262">It will contain a list of authentication attempts that have occurred over the last day where the user was not challenged for MFA.</span></span> <span data-ttu-id="7dca1-263">您將需要複查每個項目，以判斷這是否為預期的行為，並視需要採取動作。</span><span class="sxs-lookup"><span data-stu-id="7dca1-263">You will need to review each entry to determine if this is the expected behavior and act if necessary.</span></span>

![評估報告](images/security/assessment-report.png)

## <a name="common-issues"></a><span data-ttu-id="7dca1-265">常見問題</span><span class="sxs-lookup"><span data-stu-id="7dca1-265">Common issues</span></span>

### <a name="azure-active-directory"></a><span data-ttu-id="7dca1-266">Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="7dca1-266">Azure Active Directory</span></span>

#### <a name="aadsts50076"></a><span data-ttu-id="7dca1-267">AADSTS50076</span><span class="sxs-lookup"><span data-stu-id="7dca1-267">AADSTS50076</span></span>

<span data-ttu-id="7dca1-268">啟用基準原則之後，您可能會發現您的自動化或整合遇到如下的例外狀況</span><span class="sxs-lookup"><span data-stu-id="7dca1-268">After enabling the baseline policies, you might find that your automation or integration is encountering an exception like the following</span></span>

    AADSTS50076: Due to a configuration change made by your administrator, or because you moved to a new location, you must use multi-factor authentication to access 'MyApp'.

<span data-ttu-id="7dca1-269">此例外狀況的原因是您要使用使用者認證進行驗證，而且現在需要 MFA。</span><span class="sxs-lookup"><span data-stu-id="7dca1-269">The reason for this exception is that you are authenticating using user credentials and MFA is now required.</span></span> <span data-ttu-id="7dca1-270">若要解決這個例外狀況，您必須利用存取權杖來進行驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-270">To address this exception, you will need to utilize an access token for authentication.</span></span> <span data-ttu-id="7dca1-271">如需詳細資訊，請參閱[安全應用程式模型指南](http://assetsprod.microsoft.com/secure-application-model-guide.pdf)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-271">See the [Secure Application Model guide](http://assetsprod.microsoft.com/secure-application-model-guide.pdf) for more information.</span></span>

>[!IMPORTANT]
><span data-ttu-id="7dca1-272">大部分的新式 API 和 PowerShell 模組都支援使用存取權杖進行驗證的能力。</span><span class="sxs-lookup"><span data-stu-id="7dca1-272">Most modern APIs and PowerShell modules support the ability to utilize an access token for authentication.</span></span> <span data-ttu-id="7dca1-273">不過，有一些目前不支援此功能。</span><span class="sxs-lookup"><span data-stu-id="7dca1-273">However, there are some that currently do not support this functionality.</span></span> <span data-ttu-id="7dca1-274">如果您需要協助來判斷您嘗試利用的 API 或 PowerShell 模組是否支援使用存取權杖進行驗證，請在[合作夥伴中心安全性指導群組](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance)社群上張貼訊息。</span><span class="sxs-lookup"><span data-stu-id="7dca1-274">If you need help determining if the API or PowerShell module you are trying to leverage supports the use of an access token for authentication, then post a message on the [Partner Center Security Guidance Group](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) community.</span></span>

#### <a name="aadsts700082"></a><span data-ttu-id="7dca1-275">AADSTS700082</span><span class="sxs-lookup"><span data-stu-id="7dca1-275">AADSTS700082</span></span>

<span data-ttu-id="7dca1-276">一旦您實作安全應用程式模型架構，於產生初始重新整理權杖的 90天後，您可能會收到下列例外狀況</span><span class="sxs-lookup"><span data-stu-id="7dca1-276">Once you have implemented the Secure Application Model framework there is a chance you will receive the following exception 90 days after generating the initial refresh token</span></span>

    The refresh token has expired due to inactivity. The token was issued on 2019-01-02T09:19:53.5422744Z and was inactive for 90.00:00:00

<span data-ttu-id="7dca1-277">關於 Azure Active Directory，重新整理權杖的最長存留期為90天。</span><span class="sxs-lookup"><span data-stu-id="7dca1-277">With respect to Azure Active Directory the maximum lifetime for a refresh token is 90 days.</span></span> <span data-ttu-id="7dca1-278">若要解決此錯誤，您將需要產生並安全地儲存新的重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="7dca1-278">To address this error, you will need to generate and securely store a new refresh token.</span></span> <span data-ttu-id="7dca1-279">請注意，您可以透過程式設計的方式更新重新整理權杖，因為隨著對 Azure Active Directory 要求取得存取權杖的每個要求，都會傳回新的重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="7dca1-279">Note it is possible to update the refresh token programmatically because with each request to Azure Active Directory for an access token a new refresh token is returned.</span></span> <span data-ttu-id="7dca1-280">您可以實作適當的邏輯，以在到期之前更新安全儲存的重新整理權杖。</span><span class="sxs-lookup"><span data-stu-id="7dca1-280">You can implement the appropriate logic to update the securely stored refresh token before it expires.</span></span>

<span data-ttu-id="7dca1-281">如需詳細資訊，請參閱 [Azure Active Directory 中可設定的權杖存留期](https://docs.microsoft.com/azure/active-directory/develop/active-directory-configurable-token-lifetimes)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-281">See [Configurable token lifetimes in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-configurable-token-lifetimes) for more information.</span></span>

### <a name="recovering-compromised-accounts"></a><span data-ttu-id="7dca1-282">復原遭盜用的帳戶</span><span class="sxs-lookup"><span data-stu-id="7dca1-282">Recovering compromised accounts</span></span>

<span data-ttu-id="7dca1-283">為了協助保護客戶，Microsoft 的外洩認證服務會尋找公開可用的使用者名稱/密碼組。</span><span class="sxs-lookup"><span data-stu-id="7dca1-283">To help protect our customers, Microsoft’s leaked credential service finds publicly available username/password pairs.</span></span> <span data-ttu-id="7dca1-284">如果它們符合我們的其中一個使用者，我們會立即協助保護該帳戶。</span><span class="sxs-lookup"><span data-stu-id="7dca1-284">If they match one of our users, we help secure that account immediately.</span></span> <span data-ttu-id="7dca1-285">識別為有外洩認證的使用者會確認遭到入侵。</span><span class="sxs-lookup"><span data-stu-id="7dca1-285">Users identified as having a leaked credential are confirmed compromised.</span></span> <span data-ttu-id="7dca1-286">這些使用者在重設密碼之前，將會遭到封鎖而無法登入。</span><span class="sxs-lookup"><span data-stu-id="7dca1-286">These users will be blocked from signing in until their password is reset.</span></span>

<span data-ttu-id="7dca1-287">獲指派 Azure AD Premium 授權的使用者可以於其目錄中啟用該功能的情況下，透過自助式密碼重設 (SSPR) 來還原存取權。</span><span class="sxs-lookup"><span data-stu-id="7dca1-287">Users assigned an Azure AD Premium license can restore access through self-service password reset (SSPR) if the capability is enabled in their directory.</span></span> <span data-ttu-id="7dca1-288">遭到封鎖、沒有 Premium 授權的使用者，必須連絡系統管理員來執行手動密碼重設，並解除已標幟的使用者風險事件。</span><span class="sxs-lookup"><span data-stu-id="7dca1-288">Users without a premium license that become blocked must contact an administrator to perform a manual password reset and dismiss the flagged user risk event.</span></span>

#### <a name="steps-to-unblock-a-user"></a><span data-ttu-id="7dca1-289">解除封鎖使用者的步驟</span><span class="sxs-lookup"><span data-stu-id="7dca1-289">Steps to unblock a user</span></span>

<span data-ttu-id="7dca1-290">檢查使用者的登入記錄，確認使用者已遭到原則封鎖。</span><span class="sxs-lookup"><span data-stu-id="7dca1-290">Confirm that the user has been blocked by the policy by examining the user’s sign-in logs.</span></span>

1. <span data-ttu-id="7dca1-291">系統管理員必須登入 **Azure 入口網站**，並瀏覽至 [Azure Active Directory]   >  [使用者]  > 按一下使用者的名稱，然後瀏覽以進行登入。</span><span class="sxs-lookup"><span data-stu-id="7dca1-291">An administrator needs to sign in to the **Azure portal** and navigate to **Azure Active Directory** > **Users** > click on the name of the user and navigate to Sign-ins.</span></span>
2. <span data-ttu-id="7dca1-292">若要對已封鎖的使用者初始化密碼重設，系統管理員必須瀏覽至 [Azure Active Directory]   >  [標幟為有風險的使用者] </span><span class="sxs-lookup"><span data-stu-id="7dca1-292">To initiate password reset on a blocked user, an administrator needs to navigate to **Azure Active Directory** > **Users flagged for risk**</span></span>
3. <span data-ttu-id="7dca1-293">按一下帳戶已遭封鎖的使用者，以檢視使用者最近登入活動的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="7dca1-293">Click on the user whose account is blocked to view information about the user’s recent sign-in activity.</span></span>
4. <span data-ttu-id="7dca1-294">按一下 [重設密碼]，指派必須在下次登入時變更的暫時密碼。</span><span class="sxs-lookup"><span data-stu-id="7dca1-294">Click Reset Password to assign a temporary password that must be changed upon the next login.</span></span>
5. <span data-ttu-id="7dca1-295">按一下 [關閉所有事件] 以重設使用者的風險分數。</span><span class="sxs-lookup"><span data-stu-id="7dca1-295">Click Dismiss all events to reset the user’s risk score.</span></span>

<span data-ttu-id="7dca1-296">使用者現在可以登入、重設其密碼，並存取應用程式。</span><span class="sxs-lookup"><span data-stu-id="7dca1-296">The user can now sign in, reset their password, and access the application.</span></span>

## <a name="known-issues"></a><span data-ttu-id="7dca1-297">已知問題</span><span class="sxs-lookup"><span data-stu-id="7dca1-297">Known issues</span></span>

### <a name="exchange-online-powershell"></a><span data-ttu-id="7dca1-298">Exchange Online PowerShell</span><span class="sxs-lookup"><span data-stu-id="7dca1-298">Exchange Online PowerShell</span></span>

<span data-ttu-id="7dca1-299">強制執行 MFA 時，合作夥伴將無法利用其委派的系統管理權限搭配 Exchange Online PowerShell 來對客戶執行動作。</span><span class="sxs-lookup"><span data-stu-id="7dca1-299">When MFA is enforced partners will not be able to utilize their delegated administrative privileges with Exchange Online PowerShell to perform actions against their customers.</span></span> <span data-ttu-id="7dca1-300">如需有關此限制的詳細資訊，請參閱[使用多重要素驗證連接到 Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/mfa-connect-to-exchange-online-powershell)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-300">See [Connect to Exchange Online PowerShell using multi-factor authentication](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/mfa-connect-to-exchange-online-powershell) for more information regarding this limitation.</span></span>

<span data-ttu-id="7dca1-301">若要解決此限制，您可以建立新的帳戶，並且絕不使用它來執行互動式驗證。</span><span class="sxs-lookup"><span data-stu-id="7dca1-301">You can work around this limitation by creating a new account and never using it to perform an interactive authentication.</span></span> <span data-ttu-id="7dca1-302">建議您利用 [Azure AD PowerShell](https://docs.microsoft.com/powershell/module/azuread/) 來建立新帳戶並執行初始設定。</span><span class="sxs-lookup"><span data-stu-id="7dca1-302">It is recommended that you leverage [Azure AD PowerShell](https://docs.microsoft.com/powershell/module/azuread/) to create the new account and perform the initial configuration.</span></span> <span data-ttu-id="7dca1-303">下列 PowerShell 可以用來建立及設定帳戶</span><span class="sxs-lookup"><span data-stu-id="7dca1-303">The following PowerShell can be used to create and configure the account</span></span>

```powershell
Import-Module AzureAD
Connect-AzureAD

$PasswordProfile = New-Object -TypeName Microsoft.Open.AzureAD.Model.PasswordProfile

$PasswordProfile.Password = "Password"
$PasswordProfile.ForceChangePasswordNextLogin = $false

$user = New-AzureADUser -DisplayName "New User" -PasswordProfile $PasswordProfile -UserPrincipalName "NewUser@contoso.com" -AccountEnabled $true

# Uncomment the following two lines if you want the account to have Admin Agent privileges
# $adminAgentsGroup = Get-AzureADGroup -Filter "DisplayName eq 'AdminAgents'"
# Add-AzureADGroupMember -ObjectId $adminAgentsGroup.ObjectId -RefObjectId $user.ObjectId
```

<span data-ttu-id="7dca1-304">下一次使用此帳戶透過 PowerShell 連線到 Exchange Online 時，它會如預期般運作。</span><span class="sxs-lookup"><span data-stu-id="7dca1-304">Next time you connect to Exchange Online through PowerShell use this account, it will work as expected.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="7dca1-305">在執行 MFA 時，讓合作夥伴可利用其委派的系統管理權限搭配 Exchange Online PowerShell 對客戶執行動作的功能，未來將會推出。</span><span class="sxs-lookup"><span data-stu-id="7dca1-305">The ability for partners to utilize their delegated administrative privileges with Exchange Online PowerShell to perform actions against their customers, when MFA is enforced, will be available in the future.</span></span> <span data-ttu-id="7dca1-306">在那之前，您應該先利用此解決方法。</span><span class="sxs-lookup"><span data-stu-id="7dca1-306">Until then you should leverage this work around.</span></span>

## <a name="resources-and-support"></a><span data-ttu-id="7dca1-307">資源與支援</span><span class="sxs-lookup"><span data-stu-id="7dca1-307">Resources and support</span></span>

<span data-ttu-id="7dca1-308">透過[合作夥伴中心安全性指導群組社群](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance)，您可以找到其他資源，並瞭解近期的活動，例如技術辦公室工作時間。</span><span class="sxs-lookup"><span data-stu-id="7dca1-308">Through the [Partner Center Security Guidance Group community](https://www.microsoftpartnercommunity.com/t5/Partner-Center-Security-Guidance/ct-p/partner-center-security-guidance) you can will find additional resources and learn about upcoming events such as technical office hours.</span></span> <span data-ttu-id="7dca1-309">若要深入瞭解需求，請參閱[常見問題檔](partner-security-requirements-faq.md)。</span><span class="sxs-lookup"><span data-stu-id="7dca1-309">See the [frequently asked questions](partner-security-requirements-faq.md) document to learn more about the requirements.</span></span>
